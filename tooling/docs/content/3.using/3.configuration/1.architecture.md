---
title: Architecture
---

# L'organisation du magasin

::alert{type="info"}
Le magasin est structur√© en trois parties pour s√©parer l'acc√®s aux donn√©es de la transformation des donn√©es.
::

![Store's artchitecture](/using/architecture.webp "architecture")

## Les trois couchesüßÖ

### La couche des interfaces de donn√©es
Cartographie des interfaces de bases de donn√©es externes au magasin (dont GPI, GRHPAIE, Bi_distribution).

* Lorsqu'elles sont utilis√©es via `Core.dashboards_store`, les interfaces servent presque toujours √† s√©lectionner et √† renommer les colonnes.
* Vous pouvez utiliser les interfaces dans votre `cssXX.dashboards_store` pour :
  * Joindre les donn√©es provenant de plusieurs bases de donn√©es
  * Exploiter des donn√©es provenant d'un serveur externe

On ne devrait jamais retrouver de logique d'affaires dans la couche des interfaces de donn√©es. Si vous devez proc√©der √† des transformations complexes de donn√©es, vous devriez le faire dans la couche des comptoirs.

### La couche des comptoirs ("Mart")
La base du magasin.

Les comptoirs rassemblent les tables de faits et de dimensions. Le magasin est organis√© par service:**services √©ducatifs** et **ressources humaines**, etc. 
Les tables des comptoirs sont construites sur les interfaces de donn√©es en les modifiant et en les combinant. Les tables des comptoirs peuvent aussi se construire √† partir du m√™me comptoir ou d'un autre comptoir. Elles contiennent des donn√©es et des indicateurs pouvant √™tre utilis√©s en tant que blocs de construction pour les tableaux de bord.

Habituellement, une table d'un comptoir sera utilis√©e dans plus d'un tableau de bord. 

#### Fichiers de donn√©es statiques (Seeds), adaptateurs et r√®gles d'affaires

::alert{type="info"}
Les fichiers de donn√©es statiques et les adaptateurs sont des crochets de configuration qui doivent √™tre aliment√©s pour que le magasin puisse fonctionner.
::

Ce ne sont pas toutes les informations dont nous avons besoin qui peuvent √™tre tir√©es des interfaces de donn√©es. Il arrive que nous devions ajouter des r√®gles d'affaires dans le magasin. Pour ce faire, le magasin se base sur deux m√©canismes : les **fichiers de donn√©es statiques** et les **adaptateurs**.

* **Fichiers de donn√©es statiques** : Ce sont des **donn√©es arbitraires**, ajout√©es aux comptoirs. Par exemple, une fichier `csv`  t√©l√©charg√© automatiquement dans la base de donn√©es avant que l'ETL ne soit ex√©cut√©.  Une grande partie de la configuration peut √™tre faite par ces fichiers de donn√©es statiques. Par exemple, les comptoirs `human_resources` utilisent un fichier de donn√©es statiques pour d√©terminer quels codes des employ√©s devraient √™tre consid√©r√©s comme `active`. Comme il s'agit d'une d√©cision du Centre de services scolaire, le `core` ne peut pas vous fournir cette information seulement en utilisant la base de donn√©es. Vous devez ajouter vous-m√™me cette infomration au magasin pour qu'elle soit utilis√©e dans l'ETL. C'est donc surtout utilis√© pour filtrer et recartographier l'information. 
* **adaptateurs** : Ce sont des **codes SQL arbitraires**, ajout√©s dans les comptoirs. Il arrive qu'un fichier de donn√©es statiques ne soit pas suffisamment flexible pour g√©rer toutes les r√®gles d'affaires sp√©cifiques d'un CSS et que vous deviez √©crire du code SQL pour arriver √† faire le travail. On utilise alors des adaptateurs. Par exemple, les `services √©ducatifs` utilisent un adaptateur pour d√©terminer quels √©l√®ves sont inscrits en adaptation scolaire. Puisque la r√®gles d'affaires peut varier d'un CSS √† l'autre pour identifier ces √©l√®ves, il n'est pas possible de fournir une solution g√©n√©rique bas√©e sur un sous-ensemble pr√©d√©termin√© de colonnes.

### La couche de "reporting"

La couche de "reporting" est l'endroit o√π la magie op√®re. C'est o√π les tables utilis√©es par la tableau de bord sont construites.

Cette couche contient les tables sur lesquelles les tableaux de bord sont branch√©s. Les tables de "reporting" sont construites √† partir des tables des comptoirs ("Mart"). Elles peuvent utiliser des tables provenant de la m√™me couche de "reporting" ou d'une autre couche de "reporting". La diff√©rence entre la couche des comptoirs et celle du "reporting" n'est pas technique, mais plut√¥t s√©mantique : si la table sera utilis√©e dans plusieurs tableaux de bord, elle devrait se trouver dans un comptoir. Si elle ne sera utilis√©e que dans un seul tableau de bord, elle devrait se trouver dans la couche de "reporting".